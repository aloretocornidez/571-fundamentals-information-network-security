# ECE 570 | Cryptography and Network Security | Homework 3

Name: Alan Manuel Loreto Cornídez

Due Date: April 8th, 2024

## Problem 10.2

Consider a Diffie–Hellman scheme with a common prime $q=11$ and a primitive root
$\alpha = 2$

1. Show that 2 is a primitive root of 11.
2. If user A has public key $Y_A = 9$ what is A’s private key $X_{A}$ ?
3. If user B has public key $Y_B = 3$ what is the secret key $K$ shared with A?

## Problem 15.6

Consider the following protocol, designed to let A and B decide on a fresh,
shared session key $K'_{AB}$. We assume that they already share a long-term key
$K_{AB}$.

1. $A \rightarrow B : A, N_{A}$
2. $B \rightarrow A : E(K_{AB}, [N_A, K'_{AB}])$
3. $A \rightarrow B : E(K'_{AB}, N_A)$

- We first try to understand the protocol designer’s reasoning:

  - Why would A and B believe after the protocol ran that they share $K'_{AB}$
    with the other party?
  - Why would they believe that this shared key is fresh?

  - In both cases, you should explain both the reasons of both A and B, so your
    answer should complete the sentences

  - A believes that she shares $K'_{AB}$ with B since ...
  - B believes that he shares $K'_{AB}$ with A since ...
  - A believes that $K'_{AB}$is fresh since ...
  - B believes that $K'_{AB}$ is fresh since ...

- Assume now that A starts a run of this protocol with B. However, the
  connection is intercepted by the adversary C. Show how C can start a new run
  of the protocol using reflection, causing A to believe that she has agreed on
  a fresh key with B (in spite of the fact that she has only been communicating
  with C). Thus, in particular, the belief in (a) is false.

- Propose a modification of the protocol that prevents this attack.

## Problem 15.7

What are the core components of a PKI? Briefly describe each component.

## Problem 16.4

There are three typical ways to use nonces as challenges. Suppose $N_{A}$ is a
nonce generated by A, A and B share key $K$, and $f()$ is a function (such as an
increment). The three usages are:

$$
\begin{bmatrix} \text{Usage 1} && \text{Usage 2} && \text{Usage 3} \\ A \rightarrow B : N_{A} && A \rightarrow B : E(K, N_{a}) && A \rightarrow B : E(K,
N_{A}) \\ B \rightarrow A : E(K, N_{A}) && B \rightarrow A : N_{A} && B
\rightarrow A : E(K, f(N_{A})) \end{bmartix}
$$

Describe situations for which each usage is appropriate.

## Problem 16.6

Consider a one-way authentication technique based on asymmetric encryption:

$$A \rightarrow B : ID_{A}$$ $$B \rightarrow A : R_{1}$$ $$A \rightarrow B :
E(PR_{a}, R_{1})$$

- Explain the protocol
- What type of attack is this protocol susceptible to?

## Problem 6

When we talked about defenses against Man-in-the-Middle (MitM) Attack, we stated
that encrypting the Diffie-Hellman value with the other side’s public key
prevents the attack. Why is this the case, given that an attacker can encrypt
whatever it wants with the other side’s public key? In addition, describe at
least one other defense mechanism against the MitM attack and explain why it is
secure.

## Problem 7

Extend the following scenario of two KDC Domains to a chain of three KDCs. In
other words, assume that Alice wants to talk to Boris through a chain of three
KDCs (Alice’s KDC, a KDC that has shared keys with both Alice’s KDC and Boris’s
KDC, and finally, Boris’s KDC). Give the sequence of events necessary to
establish communication.

![[Pasted image 20240325111435.png]]

## Problem 8

In the class, we asserted that it is extremely difficult, without public key
cryptography, to have an authentication scheme which protects against both
eavesdropping and server database disclosure. Consider the following
authentication protocol (which is based on Novell version 3 security). Alice
knows a password. Bob, a server that will authenticate Alice, stores a hash of
Alice’s password. Alice types her password (say fiddlesticks) to her
workstation. The following exchange takes place:

![[Pasted image 20240325111458.png]]

Suppose Eve can eavesdrop the communication between Alice’s workstation and Bob
the server. Is this an example of an authentication scheme that isn’t based on
public key cryptography and yet guards against both eavesdropping and server
database disclosure?

## Problem 10.3

In the Diffie–Hellman protocol, each participant selects a secret number $x$ and
sends the other participant $\alpha \mod {q}$ for some public number $\alpha$
What would happen if the participants sent each other for some public number
$x^{\alpha}$ instead? Give at least one method Alice and Bob could use to agree
on a key.

Can Darth break your system without finding the secret numbers?

Can Darth find the secret numbers?

## Problem 15.2

“We are under great pressure, Holmes.” Detective Lestrade looked nervous. “We
have learned that copies of sensitive government documents are stored in
computers of one foreign embassy here in London. Normally these documents exist
in electronic form only on a selected few government computers that satisfy the
most stringent security requirements. However, sometimes they must be sent
through the network connecting all government computers. But all messages in
this network are encrypted using a top-secret encryption algorithm certified by
our best crypto experts. Even the NSA and the KGB are unable to break it. And
now these documents have appeared in hands of diplomats of a small, otherwise
insignificant, country. And we have no idea how it could happen.” “But you do
have some suspicion who did it, do you?” asked Holmes. “Yes, we did some routine
investigation. There is a man who has legal access to one of the government
computers and has frequent contacts with diplomats from the embassy. But the
computer he has access to is not one of the trusted ones where these documents
are normally stored. He is the suspect, but we have no idea how he could obtain
copies of the documents. Even if he could obtain a copy of an encrypted
document, he couldn’t decrypt it.” “Hmm, please describe the communication
protocol used on the network.” Holmes opened his eyes, thus proving that he had
followed Lestrade’s talk with an attention that contrasted with his sleepy look.

"The protocol is as follows. Each node $N$ of the network has been assigned a
unique secret key $K_n$. This key is used to secure communcation between the
node and a trusted server. That is, all the keys are stoed on the server. User
A, wishing to send a secret message $M$ to user B, initiates the following
protocol:

1. A generates a random number $R$ and sends to the server his name A,
   destination B, and $E(K_{a}, R)$.
2. Server responds by sending $E(K_{b}, R)$ to A.
3. A server sends $E(R, M)$ together with $E(K_b, R)$ to B.
4. B knows $K_{b}$, thus decrypts $E(K_{b}, R)$ to get $R$ and will subsequently
   user $R$ to decrypt $E(R, M)$ to get $M$.

You see that a random key is generated every times a message has to be sent. I
admit the man could intercept messages sent between the top-secret trusted
nodes, bit I see no way he could decrypt them."

"Well, I think you have your man, Lestrade. The protocol isn’t secure because
the server doesn’t authenticate users who send him a request. Apparently
designers of the protocol have believed that sending $E(K_x, R)$ implicitly
authenticates user X as the sender, as only X (and the server) knows $K_x$. But
you know that $E(K_a, R)$ and $E(R, M)$ (see steps 1 and 3 of the protocol), the
man, let's denote him as $Z$, will continue pretending to be A and ...

Finish the sentence for Holmes.
