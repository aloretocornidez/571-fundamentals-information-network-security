#include <openssl/bn.h>
#include <openssl/crypto.h>
#include <stdio.h>

#define NBITS 256

// Print out a big number.
void printBN(char *msg, BIGNUM *a);

int main() {

  // used for temporary variables.
  BN_CTX *ctx = BN_CTX_new();

  // Variables
  BIGNUM *s = BN_new();
  BIGNUM *e = BN_new();
  BIGNUM *n = BN_new();
  BIGNUM *M = BN_new();

  // initialize variables.
  BN_hex2bn(&s, "860e583aa95477489ebca9313943b98e30d780884ea4566be520ae399158e08a239244d08b6fe21efea1cd38fb983b3639b8d8d75147890f8df3ed7ef35462f17111d56d09ff32053353bbe1bbf364515dee95da2232e836b05237adf0f8030465589c0a79726fe5748241b1c853d243ee46a21a1baf5b5e18cdaf229c2d94f19fca5c94fbc010f2512784589e4893a92db0bbd367087e322998f61dc97bd78ae5c3e9e975e439cd6312355f11d2796e8285ac68b6eec5aaccb2437724efcb7c53be54a076b9724d72c1aee98ca6952ab2df3efd06c5eb976caa0efbae301cada2d17364af1d1252d84044553817957f31c7804b0591744fdea71629945baf24");
  BN_hex2bn(&e, "10001");
  BN_hex2bn(&n, "B611028B1EE3A1779B3BDCBF943EB795A7403CA1FD82F97D32068271F6F68C7FFBE8DBBC6A2E9797A38C4BF92BF6B1F9CE841DB1F9C597DEEFB9F2A3E9BC12895EA7AA52ABF82327CBA4B19C63DBD7997EF00A5EEB68A6F4C65A470D4D1033E34EB113A3C8186C4BECFC0990DF9D6429252307A1B4D23D2E60E0CFD20987BBCD48F04DC2C27A888ABBBACF5919D6AF8FB007B09E31F182C1C0DF2EA66D6C190EB5D87E261A45033DB079A49428AD0F7F26E5A808FE96E83C689453EE833A882B159609B2E07A8C2E75D69CEBA756648F964F68AE3D97C2848FC0BC40C00B5CBDF687B3356CAC18507F84E04CCD92D320E933BC5299AF32B529B3252AB448F972E1CA64F7E682108DE89DC28A88FA38668AFC63F901F978FD7B5C77FA7687FAECDFB10E799557B4BD26EFD601D1EB160ABB8E0BB5C5C58A55ABD3ACEA914B29CC19A432254E2AF16544D002CEAACE49B4EA9F7C83B0407BE743ABA76CA38F7D8981FA4CA5FFD58EC3CE4BE0B5D8B38E45CF76C0ED402BFD530FB0A7D53B0DB18AA203DE31ADCC77EA6F7B3ED6DF912212E6BEFAD832FC1063145172DE5DD61693BD296833EF3A66EC078A26DF13D757657827DE5E491400A2007F9AA821B6A9B195B0A5B90D1611DAC76C483C40E07E0D5ACD563CD19705B9CB4BED394B9CC43FD255136E24B0D671FAF4C1BACCED1BF5FE8141D800983D3AC8AE7A9837180595");

  BN_mod_exp(M, s, e, n, ctx);
  printBN("Message: ", M);

  return 0;
}

void printBN(char *msg, BIGNUM *a) {

  // Convert the BIGNUM to a number string.
  char *number_str = BN_bn2hex(a);

  // Print out the number string.
  printf("%s %s\n", msg, number_str);

  // Free the dynamically allocated memory
  OPENSSL_free(number_str);
}


